syntax = "proto3";

package files;

option go_package = "/proto";

service FileStorageService {
  // 1) Регистрация + presigned PUT
  rpc RegisterFile(RegisterFileRequest) returns (RegisterFileResponse);

  // 2) Выдать ссылку на скачивание (presigned GET)
  rpc DownloadLink(DownloadLinkRequest) returns (DownloadLinkResponse);
}

// Запрос регистрации файла → выдаём URL для загрузки
message RegisterFileRequest {
  string filename = 1;      // исходное имя (можно пустое)
  string entity_name = 2;   // название сущности, к которой файл относится (например, document)
  string content_type = 3;  // например "application/pdf"
}

message RegisterFileResponse {
  int32 file_id = 1;
  string put_url = 2;       // presigned PUT
}

// Выдать ссылку для скачивания по file_id
message DownloadLinkRequest {
  int32 file_id = 1;
}

message DownloadLinkResponse {
  string url = 1;       // presigned GET
}
